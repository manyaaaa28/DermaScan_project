<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DermaScan - AI Skin Assistant</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Allura&display=swap" rel="stylesheet">
  <script src="{{ url_for('static', filename='main.js') }}" defer></script>
</head>
<body>

  <div id="splash-screen" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #2a004f; color: #fff; display: flex; justify-content: center; align-items: center; z-index: 9999; transition: opacity 1s ease; box-shadow: 0 0 15px #bc59ff, inset 0 0 15px #bc59ff;">
    <div style="display: flex; flex-direction: column; align-items: center;">
      <div style="display: flex; align-items: center;">
        <img src="{{ url_for('static', filename='main_logo_1_-removebg-preview.png') }}" style="width: 80px; height: 80px; margin-right: 15px; object-fit: contain; filter: drop-shadow(0 0 5px #bc59ff);">
        <h1 style="font-size: 3rem; margin: 0; display: flex; align-items: center; font-family: 'Poppins', sans-serif;">
          <span id="typewriter"></span><span id="cursor"></span>
        </h1>
      </div>
      <br>
      <p style="margin-top: 10px; font-size: 1.7rem; opacity: 0.8; font-family:allura;">Advanced Skin Diagnosis, Simplified.</p>
    </div>
  </div>

  <header>
    <div class="logo-container">
      <img src="{{ url_for('static', filename='main_logo_1_-removebg-preview.png') }}" alt="logo" class="logo-img" />
      <span class="logo-hover-text">DermaScan</span>
    </div>
    <nav>
      <a href="{{ url_for('index') }}">Home</a>
      <a href="{{ url_for('appointment') }}">Appointment</a>
      <a href="{{ url_for('dashboard') }}">Dashboard</a>
    </nav>
  </header>

  <main class="main-container" style="display: flex; flex-direction: column; align-items: center; padding: 30px;">
    
    <div style="display: flex; width: 100%; justify-content: space-between; gap: 40px; margin-bottom: 40px; flex-wrap: wrap;">
        <section class="left-panel" style="flex: 1.2; min-width: 300px;">
          <div id="home" class="hero-section">
            <h2>Scan Your Skin with AI</h2>
            <p>Upload a skin image and get instant analysis for acne, rashes, or allergies â€” powered by advanced AI</p>
          </div>
          <div class="form-box">
            <form action="/predict" method="POST" enctype="multipart/form-data">
              <label class="custom-file-upload">
                <input type="file" id="imageInput" name="file" accept="image/*" required />
                Choose Image
              </label>
              <button type="submit">Analyze Now</button>
            </form>
          </div>
          <div class="result-box" id="resultBox">
            <h3>Diagnosis Result</h3>
            <p id="resultText">{{ result or 'Your result will appear here after analysis.' }}</p>
          </div>
        </section>

        <section class="right-panel" style="flex: 0.8; min-width: 300px;">
          <div class="image-square">
            {% if uploaded_image %}
              <img id="previewImage" src="{{ url_for('static', filename='uploads/' + uploaded_image) }}" alt="Analyzed skin" style="width:300px; height:300px; object-fit:cover; border-radius:15px;" />
            {% else %}
              <img id="previewImage" src="#" alt="Your skin image will appear here" style="width:300px; height:300px; object-fit:cover; border-radius:15px;" />
            {% endif %}
          </div>
          <br>
          <div id="suggestion-box">
            <h3 style="margin-top: 0; color: #e0b0ff;">ðŸ’¡ Smart Suggestion</h3>
            <ul id="suggestions" style="list-style: none; padding-left: 0; margin: 10px 0;">
              {% if result %}
                {% if 'Acne' in result %}
                  <li>âœ… Try using a gentle salicylic acid cleanser.</li>
                  <li>âœ… Avoid touching or picking at acne to prevent scarring.</li>
                {% elif 'Rash' in result %}
                  <li>âœ… Keep the affected area clean and dry.</li>
                  <li>âœ… Apply a mild soothing cream if recommended by a doctor.</li>
                {% elif 'Allergy' in result %}
                  <li>âœ… Identify and avoid the allergen.</li>
                  <li>âœ… Consult a doctor for antihistamines if symptoms persist.</li>
                {% endif %}
              {% else %}
                <li>Waiting for analysis...</li>
              {% endif %}
            </ul>
          </div>
        </section>
    </div>

    <div id="chat-box" style="background: #1a1a2e; color: #fff; padding: 20px; border-radius: 15px; width: 100%; max-width: 650px; box-shadow: 0 0 12px rgba(188, 89, 255, 0.3); border: 1px solid #bc59ff;">
      <h3 style="color: #bb86fc; margin: 0;">Ask DermaGPT Assistant:</h3>
      <textarea id="userInput" placeholder="Ask me anything about skin care..." rows="3" style="width: 100%; padding: 12px; margin-top: 10px; border-radius: 10px; border: none; background: #2a2a40; color: white;"></textarea>
      <button id="sendBtn" style="background: #bc59ff; color: white; width: 100%; padding: 10px; border-radius: 10px; border: none; margin-top: 10px; cursor: pointer; font-weight: 600;">Ask</button>
      <div id="chatResponse" style="margin-top:15px; min-height: 20px;">Iâ€™m ready to help!</div>
    </div>

  </main>

  <footer>
    &copy; 2025 DermaScan | Advanced Skin Diagnosis, Simplified.
  </footer>

  <script>
    // 1. Typewriter Effect Logic for Splash Screen
    const text = "DermaScan";
    let index = 0;
    function typeWriter() {
      const typewriterElement = document.getElementById("typewriter");
      if (typewriterElement && index < text.length) {
        typewriterElement.innerHTML += text.charAt(index);
        index++;
        setTimeout(typeWriter, 150);
      }
    }

    // 2. Control Splash Screen timing
    window.onload = function() {
      typeWriter(); // Start typewriter immediately
      
      setTimeout(() => {
        const splash = document.getElementById('splash-screen');
        if (splash) {
          splash.style.opacity = '0';
          setTimeout(() => {
            splash.style.display = 'none';
          }, 1000); // Wait for fade-out
        }
      }, 3000); // Keep visible for 3 seconds
    };

    // 3. Image Selection Preview
    const imageInput = document.getElementById('imageInput');
    const previewImage = document.getElementById('previewImage');
    if (imageInput && previewImage) {
      imageInput.addEventListener('change', function() {
        const file = this.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = function(e) { previewImage.src = e.target.result; }
          reader.readAsDataURL(file);
        }
      });
    }

    // 4. Simplified Chat Interaction (Keyword Matching)
const sendBtn = document.getElementById("sendBtn");
const userInput = document.getElementById("userInput");
const responseBox = document.getElementById("chatResponse");

if (sendBtn && userInput && responseBox) {
  sendBtn.addEventListener("click", () => {
    const message = userInput.value.trim().toLowerCase();
    if (!message) return;

    // Direct keyword responses
    if (message.includes("acne")) {
      responseBox.innerHTML = "<strong>ðŸ§  DermaGPT:</strong> For acne, try using a gentle salicylic acid cleanser and avoid touching your face.";
    } 
    else if (message.includes("rash")) {
      responseBox.innerHTML = "<strong>ðŸ§  DermaGPT:</strong> Keep the rash clean and dry. Avoid harsh soaps and use a mild soothing lotion.";
    } 
    else if (message.includes("allergy") || message.includes("allergic")) {
      responseBox.innerHTML = "<strong>ðŸ§  DermaGPT:</strong> Identify the trigger and avoid it. A cold compress can help soothe the irritation.";
    } 
    else {
      responseBox.innerHTML = "<strong>ðŸ§  DermaGPT:</strong> I'm here to help with questions about Acne, Rashes, and Allergies. Could you tell me more?";
    }

    userInput.value = ""; // Clear input after clicking
  });
}

  </script>
</body>
</html>